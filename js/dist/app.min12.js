var landmarks=[{title:"Great Pyramids of Giza",location:{lat:29.9753,lng:31.1376},country:"Egypt",city:"Cairo",heading:-70,pitch:10,zoom:0},{title:"Angkor Wat",location:{lat:13.4119,lng:103.8642},country:"Cambodia",city:"Phnom_Penh",heading:-46,pitch:-5,zoom:3},{title:"Christ the Redeemer",location:{lat:-22.9519,lng:-43.2105},country:"Brazil",city:"Rio_de_Janeiro",heading:-130,pitch:-20,zoom:0},{title:"Eiffel Tower",location:{lat:48.8584,lng:2.2945},country:"France",city:"Paris",heading:20,pitch:10,zoom:0},{title:"Statue of Liberty",location:{lat:40.6892,lng:-74.0445},country:"NY",city:"New_York",heading:5,pitch:70,zoom:0},{title:"Kaaba",location:{lat:21.4225,lng:39.8262},country:"Saudi_Arabia",city:"Mecca",heading:53,pitch:10,zoom:0},{title:"Taj Mahal",location:{lat:27.175,lng:78.0422},country:"India",city:"New_Delhi",heading:130,pitch:10,zoom:0},{title:"Colosseum",location:{lat:41.8902,lng:12.4922},country:"Italy",city:"Rome",heading:-88,pitch:10,zoom:0},{title:"El Castillo",location:{lat:20.683,lng:-88.5686},country:"Mexico",city:"Piste",heading:-152,pitch:15,zoom:0},{title:"St. Basil's Cathedral",location:{lat:55.7525,lng:37.6231},country:"Russia",city:"Moscow",heading:10,pitch:10,zoom:2},{title:"Golden Gate Bridge",location:{lat:37.8199,lng:-122.4804},country:"CA",city:"San_Francisco",heading:-90,pitch:20,zoom:0},{title:"Himeji Castle",location:{lat:34.8394,lng:134.6939},country:"Japan",city:"Himeji",heading:14,pitch:10,zoom:10},{title:"Sydney Opera House",location:{lat:-33.8568,lng:151.2153},country:"Australia",city:"Sydney",heading:170,pitch:10,zoom:0},{title:"Mount Rushmore",location:{lat:43.8791,lng:-103.4591},country:"SD",city:"Keystone",heading:-40,pitch:14,zoom:70},{title:"Hagia Sophia",location:{lat:41.0086,lng:28.9802},country:"Turkey",city:"Sultanahmet",heading:100,pitch:8,zoom:0}],Marker=function(e,t){var a=this;a.position=e.location,a.title=e.title;var o=a.makeMarkerIcon("FF0000"),i=a.makeMarkerIcon("FFFF24"),n=new google.maps.Marker({position:a.position,title:a.title,animation:google.maps.Animation.DROP,icon:o,id:e});return n.isVisible=ko.observable(!1),n.isVisible.subscribe(function(e){n.setVisible(e)}),n.isVisible(!0),n.addListener("mouseover",function(){this.setIcon(i)}),n.addListener("mouseout",function(){this.setIcon(o)}),n};Marker.prototype.makeMarkerIcon=function(e){var t=new google.maps.MarkerImage("https://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return t};var ViewModel=function(){var e=this;e.initMap=function(){var t=[{featureType:"administrative",elementType:"all",stylers:[{visibility:"on"},{lightness:33}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2e5d4"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#c5dac6"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"on"},{lightness:20}]},{featureType:"road",elementType:"all",stylers:[{lightness:20}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#c5c6c6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#e4d7c6"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#fbfaf7"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"on"},{color:"#acbcc9"}]}];e.map=new google.maps.Map(document.getElementById("map"),{center:{lat:0,lng:0},styles:t,zoom:1,mapTypeControl:!1})},e.initApp=function(){e.landmarkList=ko.observableArray(landmarks),e.query=ko.observable(""),e.initMap(),e.initMarkers(),e.searchResultsForLandmarks=ko.computed(function(){var t=e.query();return e.landmarkList().filter(function(e){return e.title.toLowerCase().indexOf(t.toLowerCase())>=0})}),e.searchResultsForMarkers=ko.computed(function(){var t=e.query().toLowerCase();return ko.utils.arrayFilter(e.landmarkList(),function(e){var a=e.marker.title.toLowerCase().indexOf(t)>=0;return e.marker.isVisible(a),a})}),e.currentMarker=ko.observable(),e.infoWindow=new google.maps.InfoWindow},e.initMarkers=function(){var t=e.map,a=new google.maps.LatLngBounds;e.landmarkList().forEach(function(o){o.marker=new Marker(o,t),o.marker.setMap(t),a.extend(o.marker.position),o.marker.addListener("click",function(){e.setAsCurrentMarker(o)})}),e.map.fitBounds(a)},e.setAsCurrentMarker=function(t){if(e.landmarkList().forEach(function(e){e.marker.setAnimation(null)}),t!=e.currentMarker()){t.marker.setMap(e.map);var a,o=t.location.lng,i=t.location.lat;a=i>46?82:i>40?i+38:i>20?i+42:i>-10?i+56:i+74;var n={lat:a,lng:o};e.map.setCenter(n),t.marker.setAnimation(google.maps.Animation.BOUNCE),e.currentLandmark=ko.observable(t.marker),e.populateInfoWindow(t,e.infoWindow)}},e.populateInfoWindow=function(t,a){function o(e,a){if(a==google.maps.StreetViewStatus.OK){var o=e.location.latLng,i=t.heading,n=t.pitch,r=t.zoom,l={position:o,pov:{heading:i,pitch:n,zoom:r},addressControl:!1,panControl:!1};new google.maps.StreetViewPanorama(document.getElementById("pano"),l)}else $("#pano").html("Error: No street view found.")}var i=t.marker;if(a.marker!=i){a.setContent(""),a.marker=i,a.addListener("closeclick",function(){a.marker=null,i.setAnimation(null)});var n="https://api.wunderground.com/api/6878610c92332316/conditions/q/"+t.country+"/"+t.city+".json",r="Error: Weather currently unavailable.",l="Error: Weather failed to load.";$.ajax({url:n,success:function(e){""===e.current_observation.weather?(a.setContent('<div class="marker-div"><h2 class="marker-title">'+i.title+'</h2><div id="pano"></div><div class="weather-div"><h3 class="weather-conditions">'+r+"</h3></div></div>"),s.getPanoramaByLocation(i.position,c,o)):(a.setContent('<div class="marker-div"><h2 class="marker-title">'+i.title+'</h2><div id="pano"></div><div class="weather-div"><h3 class="weather-conditions">'+e.current_observation.weather+'</h3><h3 class="weather-temperature">'+e.current_observation.temperature_string+"</h3></div></div>"),s.getPanoramaByLocation(i.position,c,o))},error:function(){a.setContent('<div class="marker-div"><h2 class="marker-title">'+i.title+'</h2><div id="pano"></div><div class="weather-div"><h3 class="weather-conditions">'+l+"</h3></div></div>"),s.getPanoramaByLocation(i.position,c,o)}});var s=new google.maps.StreetViewService,c=50;a.open(e.map,i)}},e.toggleHamburger=function(){$("#nav-list").animate({width:"toggle"},350)},e.initApp()},mapsUrl="https://maps.googleapis.com/maps/api/js?key=AIzaSyChzRTRR31Vc29DBXY_RQNOllbO-86QnwM&v=3";$.getScript(mapsUrl).done(function(){ko.applyBindings(new ViewModel)}).fail(function(){alert("Error: Map failed to load. Please reload page.")});